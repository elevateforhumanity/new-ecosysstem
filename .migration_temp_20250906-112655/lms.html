<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Primary Meta Tags -->
    <title>Online Learning Platform | AI & Data Science LMS | Student Dashboard | Elevate for Humanity</title>
    <meta name="title" content="Online Learning Platform | AI & Data Science LMS | Student Dashboard | Elevate for Humanity">
    <meta name="description" content="Access your AI and data science courses online. Track progress, complete assignments, and master machine learning with our interactive learning management system. 24/7 student support available.">
    <meta name="keywords" content="online learning platform, LMS, AI course dashboard, data science learning, student portal, online education, learning management system, course progress tracking, machine learning tutorials, coding bootcamp platform">

    <!-- Canonical URL -->
    <link rel="canonical" href="https://149dac3d-f555-4440-8be8-758dc290baa7-00-18qn78v70z4k6.janeway.replit.dev/lms.html">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://149dac3d-f555-4440-8be8-758dc290baa7-00-18qn78v70z4k6.janeway.replit.dev/lms.html">
    <meta property="og:title" content="Online Learning Platform | AI & Data Science LMS">
    <meta property="og:description" content="Access your AI and data science courses online. Track progress, complete assignments, and master machine learning.">
    <meta property="og:image" content="https://149dac3d-f555-4440-8be8-758dc290baa7-00-18qn78v70z4k6.janeway.replit.dev/assets/lms-og.jpg">
    <meta property="og:site_name" content="Elevate for Humanity">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://149dac3d-f555-4440-8be8-758dc290baa7-00-18qn78v70z4k6.janeway.replit.dev/lms.html">
    <meta property="twitter:title" content="Online Learning Platform | AI & Data Science LMS">
    <meta property="twitter:description" content="Access your AI and data science courses online. Track progress, complete assignments, and master machine learning.">
    <meta property="twitter:image" content="https://149dac3d-f555-4440-8be8-758dc290baa7-00-18qn78v70z4k6.janeway.replit.dev/assets/lms-twitter.jpg">

    <!-- Security & Performance -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <meta name="googlebot" content="index, follow">
    <meta name="bingbot" content="index, follow">

    <!-- Structured Data for Learning Platform -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Elevate for Humanity Learning Management System",
      "description": "Interactive online learning platform for AI and data science education",
      "url": "https://149dac3d-f555-4440-8be8-758dc290baa7-00-18qn78v70z4k6.janeway.replit.dev/lms.html",
      "applicationCategory": "EducationalApplication",
      "operatingSystem": "Web Browser",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "featureList": [
        "Course Progress Tracking",
        "Interactive Assignments",
        "Video Lectures",
        "Code Playground",
        "Certificate Generation",
        "24/7 Student Support"
      ]
    }
    </script>

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-EFHWORKFORCE01"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-EFHWORKFORCE01');
      gtag('event', 'page_view', {
        page_title: 'Learning Management System',
        page_location: window.location.href
      });
    </script>

    <!-- External Scripts -->
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/images/Elevate_for_Humanity_logo_81bf0fab.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/Elevate_for_Humanity_logo_81bf0fab.png">
    <link rel="shortcut icon" href="/images/Elevate_for_Humanity_logo_81bf0fab.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- Cache Control -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
</head>
<body class="bg-gray-50 min-h-screen" x-data="lmsApp()">
    <!-- Shared Navigation Component -->
    <div id="shared-nav"></div>

    <!-- Hero Section with Crystal Clear Banner -->
    <section class="bg-gradient-to-r from-purple-600 to-blue-700 py-20 relative overflow-hidden">
        <div class="absolute inset-0 bg-black/20"></div>
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                <div class="text-center lg:text-left">
                    <h1 class="text-4xl md:text-6xl font-bold text-white mb-6">
                        Learning Management System
                    </h1>
                    <p class="text-xl text-purple-100 mb-8">
                        Access your courses, track progress, and connect with instructors and peers
                        in our state-of-the-art learning environment.
                    </p>
                    <div class="flex flex-col sm:flex-row gap-4 justify-center lg:justify-start">
                        <a href="#courses" class="bg-white text-purple-600 px-8 py-4 rounded-lg font-bold text-lg hover:bg-gray-100 transition-colors">
                            Browse Courses
                        </a>
                        <a href="#login" class="border-2 border-white text-white px-8 py-4 rounded-lg font-medium hover:bg-white hover:text-purple-600 transition-colors">
                            Student Login
                        </a>
                    </div>
                </div>

                <!-- Hero Banner Image -->
                <div class="relative">
                    <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-6 shadow-2xl">
                        <img src="/images/AI_Data_Science_Team_1c1aed48.png"
                             alt="Learning Management System - Online Training Platform"
                             class="w-full h-80 object-cover rounded-xl shadow-xl"
                             style="image-rendering: crisp-edges; image-rendering: -webkit-optimize-contrast;">
                        <div class="absolute top-4 right-4 bg-purple-500 text-white px-4 py-2 rounded-full text-sm font-bold">
                            Live Classes
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div class="container mx-auto px-6 py-8">
        <!-- Welcome Header -->
        <div class="bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl p-8 mb-8">
            <h1 class="text-3xl font-bold mb-2">Welcome to Your Learning Dashboard</h1>
            <p class="text-blue-100" x-text="user ? `Continue your journey, ${user.name || 'Student'}!` : 'Please sign in to access your courses'"></p>
        </div>

        <!-- Quick Stats -->
        <div class="grid md:grid-cols-4 gap-6 mb-8" x-show="user">
            <div class="bg-white rounded-lg shadow-md p-6 text-center" data-testid="stat-courses">
                <div class="text-3xl font-bold text-blue-600 mb-2" x-text="enrollments.length">0</div>
                <div class="text-gray-600">Active Courses</div>
            </div>
            <div class="bg-white rounded-lg shadow-md p-6 text-center" data-testid="stat-progress">
                <div class="text-3xl font-bold text-green-600 mb-2">67%</div>
                <div class="text-gray-600">Overall Progress</div>
            </div>
            <div class="bg-white rounded-lg shadow-md p-6 text-center" data-testid="stat-assignments">
                <div class="text-3xl font-bold text-orange-600 mb-2">3</div>
                <div class="text-gray-600">Pending Assignments</div>
            </div>
            <div class="bg-white rounded-lg shadow-md p-6 text-center" data-testid="stat-certificates">
                <div class="text-3xl font-bold text-purple-600 mb-2">1</div>
                <div class="text-gray-600">Certificates Earned</div>
            </div>
        </div>

        <!-- Course Dashboard -->
        <div x-show="user && enrollments.length > 0">
            <h2 class="text-2xl font-bold text-gray-900 mb-6">My Courses</h2>

            <div class="grid lg:grid-cols-2 gap-8 mb-8">
                <template x-for="enrollment in enrollments" :key="enrollment.program_slug">
                    <div class="bg-white rounded-xl shadow-lg overflow-hidden" :data-testid="`course-card-${enrollment.program_slug}`">
                        <div class="bg-gradient-to-r p-6 text-white"
                             :class="enrollment.program_slug === 'ai-fundamentals' ? 'from-blue-500 to-blue-600' : 'from-green-500 to-green-600'">
                            <h3 class="text-xl font-bold mb-2" x-text="getCourseName(enrollment.program_slug)"></h3>
                            <p class="text-sm opacity-90" x-text="`Enrolled: ${new Date(enrollment.enrolled_at).toLocaleDateString()}`"></p>
                        </div>

                        <div class="p-6">
                            <!-- Progress Bar -->
                            <div class="mb-4">
                                <div class="flex justify-between text-sm text-gray-600 mb-2">
                                    <span>Progress</span>
                                    <span x-text="`${getCourseProgress(enrollment.program_slug)}%`"></span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-blue-600 h-2 rounded-full transition-all duration-300"
                                         :style="`width: ${getCourseProgress(enrollment.program_slug)}%`"></div>
                                </div>
                            </div>

                            <!-- Quick Actions -->
                            <div class="flex flex-col gap-3">
                                <button @click="continueLearning(enrollment.program_slug)"
                                        class="bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors"
                                        :data-testid="`button-continue-${enrollment.program_slug}`">
                                    Continue Learning
                                </button>
                                <button @click="watchVideos(enrollment.program_slug)"
                                        class="bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700 transition-colors"
                                        :data-testid="`button-videos-${enrollment.program_slug}`">
                                    📹 Watch Videos
                                </button>
                                <button @click="viewAssignments(enrollment.program_slug)"
                                        class="border-2 border-blue-600 text-blue-600 py-2 px-4 rounded-lg hover:bg-blue-50 transition-colors"
                                        :data-testid="`button-assignments-${enrollment.program_slug}`">
                                    View Assignments
                                </button>
                            </div>
                        </div>
                    </div>
                </template>
            </div>
        </div>

        <!-- No Courses Message -->
        <div x-show="user && enrollments.length === 0" class="text-center py-12">
            <div class="bg-white rounded-xl shadow-lg p-8">
                <div class="w-24 h-24 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-6">
                    <svg class="w-12 h-12 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M12 14l9-5-9-5-9 5 9 5zm0 0l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"/>
                    </svg>
                </div>
                <h3 class="text-xl font-semibold text-gray-900 mb-4">Ready to Start Learning?</h3>
                <p class="text-gray-600 mb-6">You're not enrolled in any courses yet. Browse our programs to get started!</p>
                <a href="programs.html"
                   class="bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors"
                   data-testid="button-browse-programs">
                    Browse Programs
                </a>
            </div>
        </div>

        <!-- Not Signed In Message -->
        <div x-show="!user" class="text-center py-12">
            <div class="bg-white rounded-xl shadow-lg p-8">
                <div class="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6">
                    <svg class="w-12 h-12 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10 2L3 7v11a2 2 0 002 2h10a2 2 0 002-2V7l-7-5z"/>
                    </svg>
                </div>
                <h3 class="text-xl font-semibold text-gray-900 mb-4">Sign In Required</h3>
                <p class="text-gray-600 mb-6">Please sign in to access your learning dashboard and course materials.</p>
                <a href="account.html?return=lms.html"
                   class="bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors"
                   data-testid="button-sign-in">
                    Sign In
                </a>
            </div>
        </div>

        <!-- Recent Activity -->
        <div x-show="user && enrollments.length > 0" class="bg-white rounded-xl shadow-lg p-8">
            <h2 class="text-2xl font-bold text-gray-900 mb-6">Recent Activity</h2>

            <div class="space-y-4">
                <div class="flex items-center p-4 bg-green-50 rounded-lg" data-testid="activity-assignment">
                    <div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center mr-4">
                        <svg class="w-6 h-6 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"/>
                        </svg>
                    </div>
                    <div>
                        <h4 class="font-semibold text-gray-900">Assignment Completed</h4>
                        <p class="text-gray-600 text-sm">Linear Regression Lab - Data Science Bootcamp</p>
                    </div>
                    <div class="ml-auto text-sm text-gray-500">2 days ago</div>
                </div>

                <div class="flex items-center p-4 bg-blue-50 rounded-lg" data-testid="activity-lesson">
                    <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-4">
                        <svg class="w-6 h-6 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3zM3.31 9.397L5 10.12v4.102a8.969 8.969 0 00-1.05-.174 1 1 0 01-.89-.89 11.115 11.115 0 01.25-3.762zM9.3 16.573A9.026 9.026 0 007 14.935v-3.957l1.818.78a3 3 0 002.364 0l5.508-2.361a11.026 11.026 0 01.25 3.762 1 1 0 01-.89.89 8.968 8.968 0 00-5.35 2.524 1 1 0 01-1.4 0zM6 18a1 1 0 001-1v-2.065a8.935 8.935 0 00-2-.712V17a1 1 0 001 1z"/>
                        </svg>
                    </div>
                    <div>
                        <h4 class="font-semibold text-gray-900">Lesson Completed</h4>
                        <p class="text-gray-600 text-sm">Introduction to Neural Networks - AI Fundamentals</p>
                    </div>
                    <div class="ml-auto text-sm text-gray-500">5 days ago</div>
                </div>

                <div class="flex items-center p-4 bg-purple-50 rounded-lg" data-testid="activity-certificate">
                    <div class="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center mr-4">
                        <svg class="w-6 h-6 text-purple-600" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                        </svg>
                    </div>
                    <div>
                        <h4 class="font-semibold text-gray-900">Certificate Earned</h4>
                        <p class="text-gray-600 text-sm">Python Fundamentals Certificate</p>
                    </div>
                    <div class="ml-auto text-sm text-gray-500">1 week ago</div>
                </div>
            </div>
        </div>
    </div>

    <!-- EFH Universal Header -->
    <div id="efh-header"></div>

    <!-- EFH Universal Footer -->
    <div id="efh-footer"></div>

    <!-- EFH Universal Script v2.2 - Powers Everything -->
    <script src="scripts/efh-universal.v2.2.js"
            data-assets=""
            data-payapi="https://pay.elevateforhumanity.org/api/checkout"
            data-programs="/config/health-programs.json"
            data-partners="/config/partners.json"
            data-active-tab="state-funded"
            defer></script>

    <script src="shared/supabase.js"></script>
    <script src="lms-performance.js"></script>
    <script>

        function lmsApp() {
            return {
                user: null,
                enrollments: [],

                async init() {
                    // Check authentication
                    this.user = getCurrentUser();

                    if (this.user) {
                        await this.loadEnrollments();
                    }
                },

                async loadEnrollments() {
                    try {
                        const response = await fetch(`/api/enrollments?email=${encodeURIComponent(this.user.email)}`);
                        if (response.ok) {
                            const data = await response.json();
                            this.enrollments = data.enrollments || [];
                        }
                    } catch (error) {
                        console.error('Error loading enrollments:', error);
                    }
                },

                getCourseName(slug) {
                    const names = {
                        'ai-fundamentals': 'AI Fundamentals',
                        'data-science-bootcamp': 'Data Science Bootcamp'
                    };
                    return names[slug] || slug;
                },

                getCourseProgress(slug) {
                    // Mock progress data - in real app this would come from API
                    const progress = {
                        'ai-fundamentals': 45,
                        'data-science-bootcamp': 78
                    };
                    return progress[slug] || 0;
                },

                continueLearning(slug) {
                    alert(`Opening ${this.getCourseName(slug)} course content. LMS integration coming soon!`);
                },

                watchVideos(slug) {
                    // Create video player modal
                    const modal = document.createElement('div');
                    modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
                    modal.innerHTML = `
                        <div class="bg-white rounded-xl p-6 max-w-4xl w-full mx-4">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-xl font-bold">Course Videos - ${this.getCourseName(slug)}</h3>
                                <button onclick="this.parentElement.parentElement.parentElement.remove()" 
                                        class="text-gray-500 hover:text-gray-700">
                                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                                        <path d="M10 8.586L2.929 1.515 1.515 2.929 8.586 10l-7.071 7.071 1.414 1.414L10 11.414l7.071 7.071 1.414-1.414L11.414 10l7.071-7.071-1.414-1.414L10 8.586z"/>
                                    </svg>
                                </button>
                            </div>
                            <div class="space-y-4">
                                <div class="bg-gray-100 p-4 rounded-lg">
                                    <h4 class="font-semibold mb-2">📹 Lesson 1: Introduction</h4>
                                    <video controls class="w-full rounded-lg" poster="/images/AI_Data_Science_Team_1c1aed48.png">
                                        <source src="/api/lms/video/${slug}/lesson1/intro.mp4" type="video/mp4">
                                        Your browser does not support the video tag.
                                    </video>
                                </div>
                                <div class="bg-gray-100 p-4 rounded-lg">
                                    <h4 class="font-semibold mb-2">📹 Lesson 2: Core Concepts</h4>
                                    <video controls class="w-full rounded-lg" poster="/images/AI_Data_Science_Team_1c1aed48.png">
                                        <source src="/api/lms/video/${slug}/lesson2/concepts.mp4" type="video/mp4">
                                        Your browser does not support the video tag.
                                    </video>
                                </div>
                            </div>
                        </div>
                    `;
                    document.body.appendChild(modal);
                },

                viewAssignments(slug) {
                    alert(`Loading assignments for ${this.getCourseName(slug)}. Assignment system coming soon!`);
                }
            }
        }
    </script>
</body>
</html>