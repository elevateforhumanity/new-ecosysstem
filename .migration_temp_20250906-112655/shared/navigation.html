<!-- SHARED NAVIGATION BAR for Elevate for Humanity Ecosystem -->
<nav class="bg-white border-b border-gray-200 shadow-sm sticky top-0 z-50" data-testid="main-navigation">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between h-16">
      <!-- Logo and Main Navigation -->
      <div class="flex">
        <div class="flex-shrink-0 flex items-center">
          <a href="hub.html" class="text-xl font-bold text-blue-600 hover:text-blue-700" data-testid="logo-link">
            Elevate for Humanity
          </a>
        </div>
        
        <!-- ALL CONNECTED SITES -->
        <div class="hidden sm:ml-6 sm:flex sm:space-x-2">
          <a href="hub.html" 
             class="nav-link border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-xs font-medium"
             data-testid="nav-hub">
            Hub
          </a>
          
          <a href="programs.html" 
             class="nav-link border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-xs font-medium"
             data-testid="nav-programs">
            Programs
          </a>
          
          <a href="lms.html" 
             class="nav-link border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-xs font-medium"
             data-testid="nav-lms">
            Learning
          </a>
          
          <a href="connect.html" 
             class="nav-link border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-xs font-medium"
             data-testid="nav-connect">
            Connect
          </a>
          
          <a href="demo-site.html" 
             class="nav-link border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-xs font-medium"
             data-testid="nav-payment">
            Payment
          </a>
          
          <a href="account.html" 
             class="nav-link border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-xs font-medium"
             data-testid="nav-account">
            Account
          </a>
          
          <a href="admin-approvals-dashboard.html" 
             class="nav-link border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-xs font-medium"
             data-testid="nav-admin">
            Admin
          </a>
          
          <a href="efh-ai-chat-widget.html" 
             class="nav-link border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-xs font-medium"
             data-testid="nav-chat">
            AI Chat
          </a>
          
          <a href="working-demo.html" 
             class="nav-link border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-xs font-medium"
             data-testid="nav-demo">
            Demo
          </a>
          
          <div class="relative group">
            <button class="nav-link border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-xs font-medium"
                    data-testid="nav-tools">
              Tools ▼
            </button>
            <div class="absolute top-full left-0 mt-1 w-48 bg-white border border-gray-200 rounded-lg shadow-lg hidden group-hover:block z-50">
              <a href="coupon-test.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Coupon Test</a>
              <a href="simple-coupon-test.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Simple Coupon</a>
            </div>
          </div>
        </div>
      </div>

      <!-- Right side - Account and Mobile Menu -->
      <div class="flex items-center">
        <!-- User Info (when signed in) -->
        <div id="nav-user-info" class="hidden mr-4 text-sm text-gray-600" data-testid="nav-user-info">
          <span id="nav-user-email">Loading...</span>
        </div>
        
        <!-- Account Button - Mobile and Desktop -->
        <button id="nav-account-btn" 
                class="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
                data-testid="nav-account-button">
          Account
        </button>

        <!-- Mobile menu button -->
        <div class="ml-2 flex items-center sm:hidden">
          <button id="mobile-menu-btn" 
                  class="bg-white inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500"
                  data-testid="mobile-menu-button">
            <svg class="block h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Mobile menu -->
  <div id="mobile-menu" class="sm:hidden hidden">
    <div class="pt-2 pb-3 space-y-1">
      <a href="hub.html" 
         class="mobile-nav-link bg-blue-50 border-blue-500 text-blue-700 block pl-3 pr-4 py-2 border-l-4 text-sm font-medium"
         data-testid="mobile-nav-hub">
        🏠 Hub
      </a>
      
      <a href="programs.html" 
         class="mobile-nav-link border-transparent text-gray-600 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-800 block pl-3 pr-4 py-2 border-l-4 text-sm font-medium"
         data-testid="mobile-nav-programs">
        📚 Programs
      </a>
      
      <a href="lms.html" 
         class="mobile-nav-link border-transparent text-gray-600 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-800 block pl-3 pr-4 py-2 border-l-4 text-sm font-medium"
         data-testid="mobile-nav-lms">
        🎓 Learning
      </a>
      
      <a href="connect.html" 
         class="mobile-nav-link border-transparent text-gray-600 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-800 block pl-3 pr-4 py-2 border-l-4 text-sm font-medium"
         data-testid="mobile-nav-connect">
        🤝 Connect
      </a>
      
      <a href="demo-site.html" 
         class="mobile-nav-link border-transparent text-gray-600 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-800 block pl-3 pr-4 py-2 border-l-4 text-sm font-medium"
         data-testid="mobile-nav-payment">
        💳 Payment
      </a>
      
      <a href="account.html" 
         class="mobile-nav-link border-transparent text-gray-600 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-800 block pl-3 pr-4 py-2 border-l-4 text-sm font-medium"
         data-testid="mobile-nav-account">
        👤 Account
      </a>
      
      <a href="admin-approvals-dashboard.html" 
         class="mobile-nav-link border-transparent text-gray-600 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-800 block pl-3 pr-4 py-2 border-l-4 text-sm font-medium"
         data-testid="mobile-nav-admin">
        ⚙️ Admin Dashboard
      </a>
      
      <a href="efh-ai-chat-widget.html" 
         class="mobile-nav-link border-transparent text-gray-600 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-800 block pl-3 pr-4 py-2 border-l-4 text-sm font-medium"
         data-testid="mobile-nav-chat">
        🤖 AI Chat
      </a>
      
      <a href="working-demo.html" 
         class="mobile-nav-link border-transparent text-gray-600 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-800 block pl-3 pr-4 py-2 border-l-4 text-sm font-medium"
         data-testid="mobile-nav-demo">
        🔧 Working Demo
      </a>
      
      <a href="coupon-test.html" 
         class="mobile-nav-link border-transparent text-gray-600 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-800 block pl-3 pr-4 py-2 border-l-4 text-sm font-medium"
         data-testid="mobile-nav-coupon">
        🎟️ Coupon Test
      </a>
      
      <a href="simple-coupon-test.html" 
         class="mobile-nav-link border-transparent text-gray-600 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-800 block pl-3 pr-4 py-2 border-l-4 text-sm font-medium"
         data-testid="mobile-nav-simple-coupon">
        🎫 Simple Coupon
      </a>
    </div>
  </div>
</nav>

<style>
  /* Active navigation state */
  .nav-link.active {
    border-color: #3B82F6;
    color: #3B82F6;
  }
  
  .mobile-nav-link.active {
    background-color: #EBF8FF;
    border-color: #3B82F6;
    color: #1E40AF;
  }
</style>

<script>
(function() {
  // Set active navigation state based on current page
  function setActiveNavigation() {
    const currentPage = window.location.pathname.split('/').pop() || 'hub.html';
    const navLinks = document.querySelectorAll('.nav-link, .mobile-nav-link');
    
    navLinks.forEach(link => {
      const href = link.getAttribute('href');
      if (href === currentPage || 
          (currentPage === '' && href === 'hub.html') ||
          (currentPage === 'index.html' && href === 'hub.html')) {
        link.classList.add('active');
      } else {
        link.classList.remove('active');
      }
    });
  }

  // Mobile menu toggle
  function initMobileMenu() {
    const mobileMenuBtn = document.getElementById('mobile-menu-btn');
    const mobileMenu = document.getElementById('mobile-menu');
    
    if (mobileMenuBtn && mobileMenu) {
      mobileMenuBtn.addEventListener('click', () => {
        mobileMenu.classList.toggle('hidden');
      });
    }
  }

  // Account button integration
  function initAccountButton() {
    const accountBtn = document.getElementById('nav-account-btn');
    const userInfo = document.getElementById('nav-user-info');
    const userEmail = document.getElementById('nav-user-email');
    
    if (accountBtn) {
      accountBtn.addEventListener('click', () => {
        // Trigger the existing account drawer
        const efhAccountBtn = document.getElementById('efhAcOpen');
        if (efhAccountBtn) {
          efhAccountBtn.click();
        }
      });
    }
    
    // Update user info display when user state changes
    function updateUserDisplay() {
      try {
        const currentUser = getCurrentUser && getCurrentUser();
        if (currentUser && userInfo && userEmail) {
          userEmail.textContent = currentUser.email;
          userInfo.classList.remove('hidden');
        } else if (userInfo) {
          userInfo.classList.add('hidden');
        }
      } catch (e) {
        // getCurrentUser not available yet
      }
    }
    
    // Check user state periodically
    updateUserDisplay();
    setInterval(updateUserDisplay, 2000);
  }

  // Initialize when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => {
      setActiveNavigation();
      initMobileMenu();
      initAccountButton();
    });
  } else {
    setActiveNavigation();
    initMobileMenu();
    initAccountButton();
  }
})();
</script>