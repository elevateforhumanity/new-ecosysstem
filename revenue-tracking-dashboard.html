
<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Security Headers -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com; img-src 'self' data: https:; font-src 'self' https:; connect-src 'self' https:; frame-ancestors 'none';">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    <meta http-equiv="Permissions-Policy" content="geolocation=(), microphone=(), camera=()">
    <meta http-equiv="Strict-Transport-Security" content="max-age=31536000; includeSubDomains; preload">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EFH Revenue Tracking Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <nav class="bg-white border-b border-gray-200 sticky top-0 z-50">
        
                <div class="flex-1">
                    <p class="text-sm text-gray-900">${message}</p>
                    <p class="text-xs text-gray-500">${time}</p>
                </div>
            `;
            
            feed.insertBefore(activity, feed.firstChild);
            
            // Keep only last 10 activities
            while (feed.children.length > 10) {
                feed.removeChild(feed.lastChild);
            }
        }

        function refreshData() {
            // Simulate new data - replace with actual API calls
            console.log('Refreshing data...');
            addActivity('Data refreshed', 'info');
        }

        function showNotificationModal() {
            document.getElementById('notification-modal').classList.remove('hidden');
        }

        function hideNotificationModal() {
            document.getElementById('notification-modal').classList.add('hidden');
        }

        function editListing(platform) {
            alert(`Edit listing for ${platform} - Feature coming soon!`);
        }

        async function testSMS() {
            try {
                const response = await fetch('/api/test-sms', { 
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });
                const result = await response.json();
                
                if (result.success) {
                    addActivity('Test SMS sent to 3177607908', 'success');
                    alert('üì± Test SMS sent! Check your phone.');
                } else {
                    alert('‚ùå SMS test failed: ' + result.error);
                }
            } catch (error) {
                console.error('SMS test error:', error);
                alert('‚ùå SMS test failed: ' + error.message);
            }
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initDashboard);

        // Add notification settings button to header
        document.querySelector('.flex.items-center.space-x-4').insertAdjacentHTML('beforeend', 
            '<button onclick="showNotificationModal()" class="bg-yellow-600 text-white px-4 py-2 rounded hover:bg-yellow-700">üìß Notifications</button>' +
            '<button onclick="testSMS()" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">üì± Test SMS</button>'
        );
    </script>
</body>
</html>
