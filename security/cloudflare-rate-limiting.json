{
  "cloudflare_rate_limiting_rules": {
    "description": "Enterprise-grade rate limiting and bot protection for Elevate for Humanity",
    "rules": [
      {
        "id": "efh_aggressive_rate_limit",
        "description": "Aggressive rate limiting for suspicious traffic",
        "expression": "(http.request.uri.path contains \"/api/\" or http.request.uri.path contains \"/admin/\" or http.request.uri.path contains \"/.env\" or http.request.uri.path contains \"/config/\")",
        "action": "block",
        "rate_limit": {
          "threshold": 5,
          "period": 60,
          "action": "block",
          "timeout": 3600
        },
        "enabled": true,
        "priority": 1
      },
      {
        "id": "efh_general_rate_limit",
        "description": "General rate limiting for all requests",
        "expression": "true",
        "action": "challenge",
        "rate_limit": {
          "threshold": 100,
          "period": 60,
          "action": "challenge",
          "timeout": 300
        },
        "enabled": true,
        "priority": 2
      },
      {
        "id": "efh_bot_detection",
        "description": "Advanced bot detection and blocking",
        "expression": "(cf.bot_management.score lt 30) or (http.user_agent contains \"bot\" and not cf.bot_management.verified_bot) or (http.user_agent contains \"crawler\" and not cf.bot_management.verified_bot) or (http.user_agent contains \"scraper\") or (http.user_agent contains \"spider\" and not cf.bot_management.verified_bot)",
        "action": "block",
        "enabled": true,
        "priority": 3
      },
      {
        "id": "efh_suspicious_user_agents",
        "description": "Block suspicious user agents",
        "expression": "(http.user_agent contains \"curl\") or (http.user_agent contains \"wget\") or (http.user_agent contains \"python\") or (http.user_agent contains \"java\") or (http.user_agent contains \"go-http\") or (http.user_agent contains \"node-fetch\") or (http.user_agent contains \"scrapy\") or (http.user_agent contains \"selenium\") or (http.user_agent contains \"phantomjs\") or (http.user_agent contains \"headless\")",
        "action": "block",
        "enabled": true,
        "priority": 4
      },
      {
        "id": "efh_missing_headers",
        "description": "Challenge requests missing common browser headers",
        "expression": "(not http.request.headers[\"accept\"][0]) or (not http.request.headers[\"accept-language\"][0]) or (not http.request.headers[\"accept-encoding\"][0])",
        "action": "challenge",
        "enabled": true,
        "priority": 5
      },
      {
        "id": "efh_rapid_requests",
        "description": "Block rapid sequential requests from same IP",
        "expression": "true",
        "action": "challenge",
        "rate_limit": {
          "threshold": 30,
          "period": 60,
          "action": "challenge",
          "timeout": 600
        },
        "enabled": true,
        "priority": 6
      },
      {
        "id": "efh_file_extension_protection",
        "description": "Protect sensitive file extensions",
        "expression": "(http.request.uri.path contains \".json\") or (http.request.uri.path contains \".xml\") or (http.request.uri.path contains \".csv\") or (http.request.uri.path contains \".sql\") or (http.request.uri.path contains \".bak\") or (http.request.uri.path contains \".log\") or (http.request.uri.path contains \".env\")",
        "action": "block",
        "enabled": true,
        "priority": 7
      },
      {
        "id": "efh_geographic_restrictions",
        "description": "Enhanced monitoring for high-risk countries",
        "expression": "(ip.geoip.country in {\"CN\" \"RU\" \"KP\" \"IR\"}) and (cf.bot_management.score lt 50)",
        "action": "challenge",
        "enabled": true,
        "priority": 8
      },
      {
        "id": "efh_honeypot_protection",
        "description": "Block access to honeypot paths",
        "expression": "(http.request.uri.path contains \"/admin-secret/\") or (http.request.uri.path contains \"/api-internal/\") or (http.request.uri.path contains \"/backup-files/\") or (http.request.uri.path contains \"/hidden-admin/\") or (http.request.uri.path contains \"/secret-api/\")",
        "action": "block",
        "enabled": true,
        "priority": 9
      },
      {
        "id": "efh_content_scraping_protection",
        "description": "Protect against content scraping patterns",
        "expression": "(http.request.uri.query contains \"page=\") and (http.request.uri.query contains \"limit=\") and (rate(1m) gt 20)",
        "action": "challenge",
        "enabled": true,
        "priority": 10
      }
    ]
  },
  "bot_management_settings": {
    "description": "Advanced bot management configuration",
    "settings": {
      "bot_fight_mode": true,
      "super_bot_fight_mode": true,
      "challenge_passage": 300,
      "javascript_detections": true,
      "static_resource_protection": true,
      "verified_bots": {
        "allow_google": true,
        "allow_bing": true,
        "allow_facebook": true,
        "allow_linkedin": true,
        "block_others": true
      }
    }
  },
  "security_level": "high",
  "challenge_passage": 300,
  "browser_integrity_check": true,
  "hotlink_protection": true,
  "security_headers": {
    "hsts": {
      "enabled": true,
      "max_age": 31536000,
      "include_subdomains": true,
      "preload": true
    },
    "x_frame_options": "DENY",
    "x_content_type_options": "nosniff",
    "referrer_policy": "strict-origin-when-cross-origin",
    "permissions_policy": "geolocation=(), microphone=(), camera=()"
  },
  "ddos_protection": {
    "enabled": true,
    "sensitivity": "high",
    "http_ddos_attack_protection": true,
    "rate_limiting_ddos": true
  },
  "waf_rules": {
    "description": "Web Application Firewall rules for enhanced protection",
    "managed_rules": {
      "cloudflare_managed_ruleset": true,
      "cloudflare_owasp_core_ruleset": true,
      "cloudflare_wordpress_ruleset": false,
      "cloudflare_exposed_credentials_check": true
    },
    "custom_rules": [
      {
        "description": "Block SQL injection attempts",
        "expression": "(http.request.body contains \"union select\") or (http.request.body contains \"drop table\") or (http.request.body contains \"insert into\") or (http.request.uri.query contains \"union select\")",
        "action": "block"
      },
      {
        "description": "Block XSS attempts",
        "expression": "(http.request.body contains \"<script\") or (http.request.uri.query contains \"<script\") or (http.request.body contains \"javascript:\") or (http.request.uri.query contains \"javascript:\")",
        "action": "block"
      },
      {
        "description": "Block path traversal attempts",
        "expression": "(http.request.uri.path contains \"../\") or (http.request.uri.path contains \"..\\\\\")",
        "action": "block"
      }
    ]
  },
  "page_rules": [
    {
      "url": "elevateforhumanity.org/admin/*",
      "settings": {
        "security_level": "high",
        "cache_level": "bypass",
        "disable_performance": true
      }
    },
    {
      "url": "elevateforhumanity.org/api/*",
      "settings": {
        "security_level": "high",
        "cache_level": "bypass",
        "disable_performance": true
      }
    },
    {
      "url": "elevateforhumanity.org/*.json",
      "settings": {
        "security_level": "high",
        "cache_level": "bypass",
        "forwarding_url": "https://elevateforhumanity.org/404.html"
      }
    }
  ],
  "access_rules": [
    {
      "mode": "block",
      "configuration": {
        "target": "user_agent",
        "value": "scrapy"
      },
      "notes": "Block Scrapy framework"
    },
    {
      "mode": "block",
      "configuration": {
        "target": "user_agent",
        "value": "selenium"
      },
      "notes": "Block Selenium automation"
    },
    {
      "mode": "block",
      "configuration": {
        "target": "user_agent",
        "value": "phantomjs"
      },
      "notes": "Block PhantomJS headless browser"
    },
    {
      "mode": "challenge",
      "configuration": {
        "target": "country",
        "value": "CN"
      },
      "notes": "Challenge traffic from China"
    },
    {
      "mode": "challenge",
      "configuration": {
        "target": "country",
        "value": "RU"
      },
      "notes": "Challenge traffic from Russia"
    }
  ],
  "rate_limiting_analytics": {
    "enabled": true,
    "log_matched_requests": true,
    "log_all_requests": false
  },
  "notifications": {
    "rate_limit_exceeded": {
      "enabled": true,
      "webhook_url": "https://hooks.slack.com/services/YOUR_WEBHOOK_URL",
      "email": "security@elevateforhumanity.org"
    },
    "bot_detected": {
      "enabled": true,
      "webhook_url": "https://hooks.slack.com/services/YOUR_WEBHOOK_URL",
      "email": "security@elevateforhumanity.org"
    },
    "ddos_attack": {
      "enabled": true,
      "webhook_url": "https://hooks.slack.com/services/YOUR_WEBHOOK_URL",
      "email": "security@elevateforhumanity.org",
      "sms": "+1234567890"
    }
  }
}