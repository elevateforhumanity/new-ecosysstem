
// Add this to your Express server configuration

const { adminCSP, studentCSP, publicCSP } = require('./middleware/csp');
const cspReportRouter = require('./api/csp-report');

// Use CSP reporting endpoint
app.use('/api', cspReportRouter);

// Apply CSP middleware to different routes
app.use('/admin/*', adminCSP());
app.use('/student-portal*', studentCSP());
app.use('/lms-integration*', studentCSP());
app.use('/', publicCSP());

// Example route with custom CSP
app.get('/secure-page', routeCSP('strict'), (req, res) => {
  res.render('secure-page', { cspNonce: res.locals.cspNonce });
});
